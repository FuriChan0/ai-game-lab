<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞—Å—å—è–Ω—Å –ü–∞—É–∫</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s, transform 0.3s;
        }
        
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            background-color: #0d5617;
            color: #f5f5dc;
            overflow-x: hidden;
        }
        
        body.dark-theme {
            background-color: #2c3e50;
            color: #ecf0f1;
        }
        
        .container {
            background-color: #2e8b57;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            width: auto;
            max-width: 95vw;
            transition: all 0.5s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
            z-index: 5;
        }
        
        body.dark-theme .container {
            background-color: #34495e;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 28px;
            color: #f5f5dc;
            transition: transform 0.3s;
        }
        
        h1:hover {
            transform: scale(1.05);
        }
        
        body.dark-theme h1 {
            color: #27ae60;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            background-color: rgba(245, 245, 220, 0.2);
            padding: 10px;
            border-radius: 5px;
            width: 100%;
            transition: transform 0.3s;
        }
        
        .game-info:hover {
            transform: translateY(-2px);
        }
        
        body.dark-theme .game-info {
            background-color: #2c3e50;
        }
        
        .moves, .timer {
            font-size: 18px;
            font-weight: bold;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            width: 100%;
            position: relative;
            z-index: 10;
        }
        
        button {
            background-color: #3cb371;
            border: none;
            color: #f5f5dc;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        button::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        
        button:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }
        
        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 1;
            }
            20% {
                transform: scale(20, 20);
                opacity: 1;
            }
            100% {
                transform: scale(50, 50);
                opacity: 0;
            }
        }
        
        button:hover {
            background-color: #2e8b57;
            transform: translateY(-2px);
        }
        
        button:disabled {
            background-color: #555;
            cursor: not-allowed;
            transform: none;
        }
        
        body.dark-theme button {
            background-color: #3498db;
            color: #ecf0f1;
        }
        
        body.dark-theme button:hover {
            background-color: #2980b9;
        }
        
        .game-area {
            width: 100%;
            min-height: 500px;
            position: relative;
            margin-bottom: 40px;
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 8px;
            margin: 0 auto;
            width: 100%;
            justify-content: center;
        }
        
        .tableau {
            min-height: 120px;
            background-color: rgba(245, 245, 220, 0.1);
            border-radius: 5px;
            border: 2px dashed #3cb371;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }
        
        body.dark-theme .tableau {
            background-color: rgba(44, 62, 80, 0.5);
            border-color: #3498db;
        }
        
        .card {
            width: 70px;
            height: 100px;
            background-color: #f5f5dc;
            border-radius: 5px;
            border: 1px solid #3cb371;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 4px;
            position: absolute;
            cursor: grab;
            user-select: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
        }
        
        .card.dragging {
            cursor: grabbing;
            z-index: 1000;
            transform: rotate(3deg);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            opacity: 0.9;
        }
        
        .card.dragging-source {
            opacity: 0.5;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }
        
        .card.red {
            color: #c44;
        }
        
        .card.black {
            color: #2c3e50;
        }
        
        body.dark-theme .card {
            background-color: #2c3e50;
            border-color: #3498db;
        }
        
        body.dark-theme .card.red {
            color: #e74c3c;
        }
        
        body.dark-theme .card.black {
            color: #ecf0f1;
        }
        
        .card-value {
            font-size: 16px;
            font-weight: bold;
            text-align: center;
        }
        
        .card-suit {
            font-size: 20px;
            text-align: center;
        }
        
        .card-top, .card-bottom {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .card-bottom {
            align-items: flex-end;
            transform: rotate(180deg);
        }
        
        .card-back {
            background: repeating-linear-gradient(
                45deg,
                #3cb371,
                #3cb371 10px,
                #2e8b57 10px,
                #2e8b57 20px
            );
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 20px;
        }
        
        body.dark-theme .card-back {
            background: repeating-linear-gradient(
                45deg,
                #27ae60,
                #27ae60 10px,
                #2c3e50 10px,
                #2c3e50 20px
            );
        }
        
        .tableau .card {
            margin-top: 25px;
        }
        
        .tableau .card:first-child {
            margin-top: 0;
        }
        
        .completed-set {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
        }
        
        .completed-card {
            width: 30px;
            height: 40px;
            background-color: #f5f5dc;
            border-radius: 3px;
            border: 1px solid #3cb371;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        body.dark-theme .completed-card {
            background-color: #2c3e50;
            border-color: #3498db;
        }
        
        .game-status {
            text-align: center;
            margin-top: 15px;
            font-weight: bold;
            min-height: 24px;
            transition: all 0.3s;
            position: relative;
            z-index: 10;
        }
        
        .win {
            color: #3cb371;
            animation: win 1s infinite alternate;
        }
        
        @keyframes win {
            from {
                transform: scale(1);
            }
            to {
                transform: scale(1.1);
            }
        }
        
        .instructions {
            margin-top: 30px;
            text-align: center;
            color: #f5f5dc;
            font-size: 14px;
            transition: all 0.3s;
            position: relative;
            z-index: 10;
            padding: 10px;
            background-color: rgba(245, 245, 220, 0.1);
            border-radius: 5px;
            width: 100%;
        }
        
        body.dark-theme .instructions {
            color: #bdc3c7;
            background-color: rgba(44, 62, 80, 0.8);
        }
        
        .theme-toggle {
            margin-top: 20px;
            background: none;
            border: 2px solid #3cb371;
            color: #f5f5dc;
            padding: 5px 10px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            position: relative;
            z-index: 10;
        }
        
        body.dark-theme .theme-toggle {
            border-color: #3498db;
            color: #ecf0f1;
        }
        
        .theme-icon {
            transition: transform 0.5s;
        }
        
        .theme-toggle:hover .theme-icon {
            transform: rotate(180deg);
        }
        
        @media (max-width: 1200px) {
            .card {
                width: 60px;
                height: 85px;
            }
            
            .card-value {
                font-size: 14px;
            }
            
            .card-suit {
                font-size: 18px;
            }
        }
        
        @media (max-width: 900px) {
            .card {
                width: 50px;
                height: 75px;
            }
            
            .card-value {
                font-size: 12px;
            }
            
            .card-suit {
                font-size: 16px;
            }
            
            .game-board {
                grid-template-columns: repeat(5, 1fr);
            }
        }
        
        @media (max-width: 600px) {
            .card {
                width: 40px;
                height: 60px;
            }
            
            .card-value {
                font-size: 10px;
            }
            
            .card-suit {
                font-size: 12px;
            }
            
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .game-area {
                min-height: 350px;
                margin-bottom: 30px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 100%;
                margin-bottom: 5px;
            }
            
            .game-board {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        .drop-target {
            box-shadow: 0 0 10px rgba(60, 179, 113, 0.8);
        }
        
        body.dark-theme .drop-target {
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.8);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>–ü–ê–°–¨–Ø–ù–° –ü–ê–£–ö</h1>
        
        <div class="game-info">
            <div class="moves">–•–æ–¥—ã: <span id="moves-count">0</span></div>
            <div class="timer">–í—Ä–µ–º—è: <span id="time">0</span></div>
        </div>
        
        <div class="controls">
            <button id="new-game-btn">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            <button id="undo-btn" disabled>–í–µ—Ä–Ω—É—Ç—å —Ö–æ–¥</button>
            <button id="hint-btn">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
        </div>
        
        <div class="game-area">
            <div class="completed-set" id="completed-set"></div>
            <div class="game-board" id="game-board">
                <!-- –ò–≥—Ä–æ–≤—ã–µ —Å—Ç–æ–ª–±—Ü—ã -->
                <div class="tableau" id="tableau-0"></div>
                <div class="tableau" id="tableau-1"></div>
                <div class="tableau" id="tableau-2"></div>
                <div class="tableau" id="tableau-3"></div>
                <div class="tableau" id="tableau-4"></div>
                <div class="tableau" id="tableau-5"></div>
                <div class="tableau" id="tableau-6"></div>
                <div class="tableau" id="tableau-7"></div>
                <div class="tableau" id="tableau-8"></div>
                <div class="tableau" id="tableau-9"></div>
            </div>
        </div>
        
        <div class="game-status" id="game-status"></div>
        
        <div class="instructions">
            –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –∫–∞—Ä—Ç—ã –º–µ–∂–¥—É —Å—Ç–æ–ª–±—Ü–∞–º–∏, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç –∫–æ—Ä–æ–ª—è –¥–æ —Ç—É–∑–∞. 
            –ö–æ–≥–¥–∞ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è.
        </div>
        
        <button class="theme-toggle" id="theme-toggle">
            <span class="theme-icon">üåì</span> –°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É
        </button>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–≥—Ä—ã
        const SUITS = ['hearts', 'diamonds', 'clubs', 'spades'];
        const VALUES = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            deck: [],
            tableau: [[], [], [], [], [], [], [], [], [], []],
            completedSets: 0,
            moves: 0,
            startTime: null,
            timerInterval: null,
            theme: 'light',
            draggingCard: null,
            dragOffset: { x: 0, y: 0 },
            draggingStack: [],
            history: [],
            maxHistory: 50 // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ö–æ–¥–æ–≤ –≤ –∏—Å—Ç–æ—Ä–∏–∏
        };
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const movesCountElement = document.getElementById('moves-count');
        const timeElement = document.getElementById('time');
        const gameStatusElement = document.getElementById('game-status');
        const newGameButton = document.getElementById('new-game-btn');
        const undoButton = document.getElementById('undo-btn');
        const hintButton = document.getElementById('hint-btn');
        const themeToggle = document.getElementById('theme-toggle');
        const completedSetElement = document.getElementById('completed-set');
        const body = document.body;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            clearInterval(gameState.timerInterval);
            
            gameState.deck = createDeck();
            gameState.tableau = [[], [], [], [], [], [], [], [], [], []];
            gameState.completedSets = 0;
            gameState.moves = 0;
            gameState.startTime = null;
            gameState.draggingCard = null;
            gameState.draggingStack = [];
            gameState.history = [];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            movesCountElement.textContent = '0';
            timeElement.textContent = '0';
            gameStatusElement.textContent = '';
            gameStatusElement.classList.remove('win');
            completedSetElement.innerHTML = '';
            undoButton.disabled = true;
            
            // –û—á–∏—â–∞–µ–º –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ
            document.querySelectorAll('.tableau').forEach(container => {
                container.innerHTML = '';
            });
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –∫–æ–ª–æ–¥—É
            shuffleDeck(gameState.deck);
            
            // –†–∞–∑–¥–∞–µ–º –∫–∞—Ä—Ç—ã –Ω–∞ –∏–≥—Ä–æ–≤—ã–µ —Å—Ç–æ–ª–±—Ü—ã
            dealCards();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            addEventListeners();
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ª–æ–¥—ã (2 –∫–æ–ª–æ–¥—ã –ø–æ 52 –∫–∞—Ä—Ç—ã)
        function createDeck() {
            const deck = [];
            
            // –î–≤–µ –∫–æ–ª–æ–¥—ã
            for (let d = 0; d < 2; d++) {
                for (const suit of SUITS) {
                    for (const value of VALUES) {
                        deck.push({
                            suit,
                            value,
                            color: (suit === 'hearts' || suit === 'diamonds') ? 'red' : 'black',
                            isFaceUp: false
                        });
                    }
                }
            }
            
            return deck;
        }
        
        // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –∫–æ–ª–æ–¥—ã
        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
        }
        
        // –†–∞–∑–¥–∞—á–∞ –∫–∞—Ä—Ç—ã
        function dealCards() {
            // –ü–µ—Ä–≤—ã–µ 4 —Å—Ç–æ–ª–±—Ü–∞ –ø–æ–ª—É—á–∞—é—Ç –ø–æ 6 –∫–∞—Ä—Ç, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ 5
            const cardsPerColumn = [6, 6, 6, 6, 5, 5, 5, 5, 5, 5];
            let cardIndex = 0;
            
            for (let i = 0; i < 10; i++) {
                for (let j = 0; j < cardsPerColumn[i]; j++) {
                    const card = gameState.deck[cardIndex++];
                    // –ü–æ—Å–ª–µ–¥–Ω—è—è –∫–∞—Ä—Ç–∞ –≤ –∫–∞–∂–¥–æ–º —Å—Ç–æ–ª–±—Ü–µ –æ—Ç–∫—Ä—ã—Ç–∞
                    card.isFaceUp = (j === cardsPerColumn[i] - 1);
                    gameState.tableau[i].push(card);
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
            updateTableView();
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –∏—Å—Ç–æ—Ä–∏—é
        function saveState() {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ, –∞ –Ω–µ DOM-—ç–ª–µ–º–µ–Ω—Ç—ã
            const stateToSave = {
                tableau: JSON.parse(JSON.stringify(gameState.tableau)),
                completedSets: gameState.completedSets,
                moves: gameState.moves
            };
            
            gameState.history.push(stateToSave);
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏
            if (gameState.history.length > gameState.maxHistory) {
                gameState.history.shift();
            }
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –æ—Ç–º–µ–Ω—ã
            undoButton.disabled = false;
        }
        
        // –û—Ç–º–µ–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ö–æ–¥–∞
        function undo() {
            if (gameState.history.length === 0) return;
            
            const previousState = gameState.history.pop();
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            gameState.tableau = previousState.tableau;
            gameState.completedSets = previousState.completedSets;
            gameState.moves = previousState.moves;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            movesCountElement.textContent = gameState.moves;
            updateTableView();
            updateCompletedSets();
            
            // –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É, –µ—Å–ª–∏ –∏—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞
            if (gameState.history.length === 0) {
                undoButton.disabled = true;
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
        function updateTableView() {
            for (let i = 0; i < 10; i++) {
                const tableauElement = document.getElementById(`tableau-${i}`);
                tableauElement.innerHTML = '';
                
                gameState.tableau[i].forEach((card, index) => {
                    const cardElement = createCardElement(card);
                    
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –∫–∞—Ä—Ç—ã –≤ —Å—Ç–æ–ª–±—Ü–µ
                    cardElement.style.top = `${index * 25}px`;
                    
                    tableauElement.appendChild(cardElement);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–∞—Ä—Ç—ã
                    if (card.isFaceUp) {
                        addCardEventListeners(cardElement, card, 'tableau', i, index);
                    }
                });
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –Ω–∞–±–æ—Ä–æ–≤
        function updateCompletedSets() {
            completedSetElement.innerHTML = '';
            
            for (let i = 0; i < gameState.completedSets; i++) {
                const completedCard = document.createElement('div');
                completedCard.className = 'completed-card';
                completedCard.textContent = 'K-A';
                completedSetElement.appendChild(completedCard);
            }
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–∞—Ä—Ç—ã
        function createCardElement(card) {
            const cardElement = document.createElement('div');
            
            if (!card.isFaceUp) {
                // –ö–∞—Ä—Ç–∞ –∑–∞–∫—Ä—ã—Ç–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä—É–±–∞—à–∫—É
                cardElement.className = 'card card-back';
                cardElement.textContent = 'üé¥';
            } else {
                // –ö–∞—Ä—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –º–∞—Å—Ç—å
                cardElement.className = `card ${card.color}`;
                cardElement.setAttribute('data-value', card.value);
                cardElement.setAttribute('data-suit', card.suit);
                
                const topElement = document.createElement('div');
                topElement.className = 'card-top';
                
                const valueElement = document.createElement('div');
                valueElement.className = 'card-value';
                valueElement.textContent = card.value;
                
                const suitElement = document.createElement('div');
                suitElement.className = 'card-suit';
                suitElement.textContent = getSuitSymbol(card.suit);
                
                topElement.appendChild(valueElement);
                topElement.appendChild(suitElement);
                
                const bottomElement = document.createElement('div');
                bottomElement.className = 'card-bottom';
                
                const valueElement2 = document.createElement('div');
                valueElement2.className = 'card-value';
                valueElement2.textContent = card.value;
                
                const suitElement2 = document.createElement('div');
                suitElement2.className = 'card-suit';
                suitElement2.textContent = getSuitSymbol(card.suit);
                
                bottomElement.appendChild(valueElement2);
                bottomElement.appendChild(suitElement2);
                
                cardElement.appendChild(topElement);
                cardElement.appendChild(bottomElement);
            }
            
            return cardElement;
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–∞ –º–∞—Å—Ç–∏
        function getSuitSymbol(suit) {
            switch (suit) {
                case 'hearts': return '‚ô•';
                case 'diamonds': return '‚ô¶';
                case 'clubs': return '‚ô£';
                case 'spades': return '‚ô†';
                default: return '';
            }
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–∞—Ä—Ç—ã
        function addCardEventListeners(cardElement, card, sourceType, sourceIndex = null, cardIndex = null) {
            cardElement.addEventListener('mousedown', (e) => {
                if (gameState.startTime === null) {
                    gameState.startTime = Date.now();
                    startTimer();
                }
                
                startDragging(cardElement, card, sourceType, sourceIndex, cardIndex, e);
                e.preventDefault();
            });
        }
        
        // –ù–∞—á–∞–ª–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –∫–∞—Ä—Ç—ã
        function startDragging(cardElement, card, sourceType, sourceIndex, cardIndex, e) {
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–æ–ø–∫—É –∫–∞—Ä—Ç –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
            let cardsToDrag = [];
            
            if (sourceType === 'tableau') {
                // –î–ª—è tableau –±–µ—Ä–µ–º –≤—Å–µ –∫–∞—Ä—Ç—ã –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π –¥–æ –∫–æ–Ω—Ü–∞ —Å—Ç–æ–ª–±—Ü–∞
                cardsToDrag = gameState.tableau[sourceIndex].slice(cardIndex);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –∫–∞—Ä—Ç—ã –≤ —Å—Ç–æ–ø–∫–µ –æ–±—Ä–∞–∑—É—é—Ç –≤–∞–ª–∏–¥–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
                for (let i = 1; i < cardsToDrag.length; i++) {
                    const prevCard = cardsToDrag[i - 1];
                    const currCard = cardsToDrag[i];
                    
                    // –í –ø–∞—Å—å—è–Ω—Å–µ –ü–∞—É–∫ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –∫–∞—Ä—Ç—ã
                    if (getCardValue(currCard.value) !== getCardValue(prevCard.value) - 1) {
                        // –ù–µ–≤–∞–ª–∏–¥–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å - –±–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –¥–æ —ç—Ç–æ–π –∫–∞—Ä—Ç—ã
                        cardsToDrag = cardsToDrag.slice(0, i);
                        break;
                    }
                }
                
                // –ü–æ–º–µ—á–∞–µ–º –≤—Å–µ –∫–∞—Ä—Ç—ã –≤ —Å—Ç–æ–ø–∫–µ –∫–∞–∫ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ–º—ã–µ
                const tableauElement = document.getElementById(`tableau-${sourceIndex}`);
                const cardElements = tableauElement.querySelectorAll('.card');
                for (let i = cardIndex; i < cardIndex + cardsToDrag.length; i++) {
                    if (cardElements[i]) {
                        cardElements[i].classList.add('dragging-source');
                    }
                }
            }
            
            gameState.draggingStack = cardsToDrag;
            
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
            const dragElement = createCardElement(card);
            dragElement.classList.add('dragging');
            dragElement.style.position = 'fixed';
            dragElement.style.left = `${e.clientX - 35}px`;
            dragElement.style.top = `${e.clientY - 50}px`;
            dragElement.style.width = `${cardElement.offsetWidth}px`;
            dragElement.style.height = `${cardElement.offsetHeight}px`;
            dragElement.style.margin = '0';
            dragElement.style.zIndex = '1000';
            
            document.body.appendChild(dragElement);
            
            gameState.draggingCard = {
                element: dragElement,
                card,
                sourceType,
                sourceIndex,
                cardIndex,
                cards: cardsToDrag
            };
            
            // –í—ã—á–∏—Å–ª—è–µ–º —Å–º–µ—â–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–∞—Ä—Ç—ã
            const rect = cardElement.getBoundingClientRect();
            gameState.dragOffset = {
                x: e.clientX - rect.left,
                y: e.clientY - rect.top
            };
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
            document.addEventListener('mousemove', handleDragMove);
            document.addEventListener('mouseup', handleDragEnd);
            
            // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ü–µ–ª–∏ –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
            highlightDropTargets(card);
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–≤–∏–∂–µ–Ω–∏—è –º—ã—à–∏ –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏
        function handleDragMove(e) {
            if (!gameState.draggingCard) return;
            
            const dragElement = gameState.draggingCard.element;
            dragElement.style.left = `${e.clientX - gameState.dragOffset.x}px`;
            dragElement.style.top = `${e.clientY - gameState.dragOffset.y}px`;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞–¥ –∫–∞–∫–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫—É—Ä—Å–æ—Ä
            const elements = document.elementsFromPoint(e.clientX, e.clientY);
            let dropTarget = null;
            let dropTargetType = null;
            
            for (const element of elements) {
                if (element.classList.contains('tableau')) {
                    dropTarget = element;
                    dropTargetType = 'tableau';
                    break;
                } else if (element.classList.contains('card')) {
                    // –ï—Å–ª–∏ –∫—É—Ä—Å–æ—Ä –Ω–∞–¥ –∫–∞—Ä—Ç–æ–π, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –µ–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
                    const container = element.closest('.tableau');
                    if (container) {
                        dropTarget = container;
                        dropTargetType = 'tableau';
                        break;
                    }
                }
            }
            
            // –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            document.querySelectorAll('.tableau').forEach(el => {
                el.classList.remove('drop-target');
            });
            
            // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º —Ü–µ–ª–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç, –µ—Å–ª–∏ –æ–Ω –ø–æ–¥—Ö–æ–¥–∏—Ç
            if (dropTarget && isValidDropTarget(dropTarget, dropTargetType)) {
                dropTarget.classList.add('drop-target');
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
        function handleDragEnd(e) {
            if (!gameState.draggingCard) return;
            
            // –£–±–∏—Ä–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
            gameState.draggingCard.element.remove();
            
            // –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            document.querySelectorAll('.tableau').forEach(el => {
                el.classList.remove('drop-target');
            });
            
            // –£–±–∏—Ä–∞–µ–º –ø–æ–º–µ—Ç–∫—É –æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏ —Å –∏—Å—Ö–æ–¥–Ω—ã—Ö –∫–∞—Ä—Ç
            document.querySelectorAll('.dragging-source').forEach(el => {
                el.classList.remove('dragging-source');
            });
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –Ω–∞–¥ –∫–∞–∫–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –±—ã–ª–∞ –æ—Ç–ø—É—â–µ–Ω–∞ –∫–∞—Ä—Ç–∞
            const elements = document.elementsFromPoint(e.clientX, e.clientY);
            let targetElement = null;
            let targetType = null;
            let targetIndex = null;
            
            for (const element of elements) {
                if (element.classList.contains('tableau')) {
                    targetElement = element;
                    targetType = 'tableau';
                    targetIndex = parseInt(element.id.split('-')[1]);
                    break;
                } else if (element.classList.contains('card')) {
                    // –ï—Å–ª–∏ –æ—Ç–ø—É—Å—Ç–∏–ª–∏ –Ω–∞–¥ –∫–∞—Ä—Ç–æ–π, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –µ–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
                    const container = element.closest('.tableau');
                    if (container) {
                        targetElement = container;
                        targetType = 'tableau';
                        targetIndex = parseInt(container.id.split('-')[1]);
                        break;
                    }
                }
            }
            
            if (targetElement && targetType) {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ–º
                saveState();
                
                // –ü—ã—Ç–∞–µ–º—Å—è –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∫–∞—Ä—Ç—É
                moveCard(gameState.draggingCard, targetType, targetIndex);
            }
            
            // –£–±–∏—Ä–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            document.removeEventListener('mousemove', handleDragMove);
            document.removeEventListener('mouseup', handleDragEnd);
            
            gameState.draggingCard = null;
            gameState.draggingStack = [];
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç–ª–µ–º–µ–Ω—Ç –¥–æ–ø—É—Å—Ç–∏–º–æ–π —Ü–µ–ª—å—é –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
        function isValidDropTarget(targetElement, targetType) {
            if (!gameState.draggingCard) return false;
            
            const card = gameState.draggingCard.cards[0]; // –ë–µ—Ä–µ–º –ø–µ—Ä–≤—É—é –∫–∞—Ä—Ç—É –≤ —Å—Ç–æ–ø–∫–µ
            
            if (targetType === 'tableau') {
                const targetIndex = parseInt(targetElement.id.split('-')[1]);
                
                if (gameState.tableau[targetIndex].length === 0) {
                    // –ú–æ–∂–Ω–æ –∫–ª–∞—Å—Ç—å –ª—é–±—É—é –∫–∞—Ä—Ç—É –Ω–∞ –ø—É—Å—Ç–æ–π —Å—Ç–æ–ª–±–µ—Ü –≤ –ø–∞—Å—å—è–Ω—Å–µ –ü–∞—É–∫
                    return true;
                } else {
                    const topCard = gameState.tableau[targetIndex][gameState.tableau[targetIndex].length - 1];
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π (–∫–∞—Ä—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –≤—ã—à–µ)
                    return getCardValue(topCard.value) === getCardValue(card.value) + 1;
                }
            }
            
            return false;
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∏—Å–ª–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞—Ä—Ç—ã
        function getCardValue(value) {
            const values = {
                'A': 1, '2': 2, '3': 3, '4': 4, '5': 5, 
                '6': 6, '7': 7, '8': 8, '9': 9, '10': 10, 
                'J': 11, 'Q': 12, 'K': 13
            };
            return values[value];
        }
        
        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ü–µ–ª–µ–π –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
        function highlightDropTargets(card) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–ª–±—Ü—ã
            for (let i = 0; i < 10; i++) {
                const tableau = document.getElementById(`tableau-${i}`);
                if (isValidDropTarget(tableau, 'tableau')) {
                    tableau.classList.add('drop-target');
                }
            }
        }
        
        // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã
        function moveCard(draggingCard, targetType, targetIndex) {
            let moved = false;
            const { sourceType, sourceIndex, cardIndex, cards } = draggingCard;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ–ø—É—Å—Ç–∏–º –ª–∏ —Ö–æ–¥
            const targetElement = document.getElementById(`${targetType}-${targetIndex}`);
            if (!isValidDropTarget(targetElement, targetType)) {
                return false;
            }
            
            if (sourceType === 'tableau' && targetType === 'tableau') {
                // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –º–µ–∂–¥—É —Å—Ç–æ–ª–±—Ü–∞–º–∏
                if (sourceIndex !== targetIndex) {
                    // –£–¥–∞–ª—è–µ–º –∫–∞—Ä—Ç—ã –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞
                    gameState.tableau[sourceIndex].splice(cardIndex, cards.length);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç—ã –≤ —Ü–µ–ª–µ–≤–æ–π —Å—Ç–æ–ª–±–µ—Ü
                    gameState.tableau[targetIndex] = gameState.tableau[targetIndex].concat(cards);
                    
                    // –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –∫–∞—Ä—Ç—É –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Å—Ç–æ–ª–±—Ü–µ, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
                    if (gameState.tableau[sourceIndex].length > 0) {
                        const topCard = gameState.tableau[sourceIndex][gameState.tableau[sourceIndex].length - 1];
                        if (!topCard.isFaceUp) {
                            topCard.isFaceUp = true;
                        }
                    }
                    
                    moved = true;
                }
            }
            
            if (moved) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
                updateTableView();
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ —Ö–æ–¥–æ–≤
                gameState.moves++;
                movesCountElement.textContent = gameState.moves;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                checkCompletedSequences();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏–µ –ø–æ–±–µ–¥—ã
                checkWinCondition();
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
        function checkCompletedSequences() {
            for (let i = 0; i < 10; i++) {
                const column = gameState.tableau[i];
                if (column.length >= 13) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø–æ–ª–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç K –¥–æ A
                    let isCompleteSequence = true;
                    for (let j = 0; j < 13; j++) {
                        const index = column.length - 1 - j;
                        if (index < 0 || getCardValue(column[index].value) !== 13 - j) {
                            isCompleteSequence = false;
                            break;
                        }
                    }
                    
                    if (isCompleteSequence) {
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                        saveState();
                        
                        // –£–¥–∞–ª—è–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
                        gameState.tableau[i].splice(-13, 13);
                        
                        // –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –∫–∞—Ä—Ç—É –≤ —Å—Ç–æ–ª–±—Ü–µ, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
                        if (gameState.tableau[i].length > 0) {
                            const topCard = gameState.tableau[i][gameState.tableau[i].length - 1];
                            if (!topCard.isFaceUp) {
                                topCard.isFaceUp = true;
                            }
                        }
                        
                        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –Ω–∞–±–æ—Ä–æ–≤
                        gameState.completedSets++;
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
                        updateTableView();
                        updateCompletedSets();
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏–µ –ø–æ–±–µ–¥—ã
                        checkWinCondition();
                    }
                }
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è –ø–æ–±–µ–¥—ã
        function checkWinCondition() {
            if (gameState.completedSets === 8) {
                gameStatusElement.textContent = '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!';
                gameStatusElement.classList.add('win');
                clearInterval(gameState.timerInterval);
            }
        }
        
        // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
        function startTimer() {
            clearInterval(gameState.timerInterval);
            
            gameState.timerInterval = setInterval(() => {
                const elapsedSeconds = Math.floor((Date.now() - gameState.startTime) / 1000);
                timeElement.textContent = elapsedSeconds;
            }, 1000);
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function addEventListeners() {
            newGameButton.addEventListener('click', initGame);
            
            undoButton.addEventListener('click', undo);
            
            hintButton.addEventListener('click', showHint);
            
            themeToggle.addEventListener('click', toggleTheme);
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É
        function showHint() {
            // –í—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ö–æ–¥—ã
            document.querySelectorAll('.card').forEach(card => {
                card.style.boxShadow = 'none';
            });
            
            // –ù–∞—Ö–æ–¥–∏–º –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ö–æ–¥—ã
            for (let i = 0; i < 10; i++) {
                const column = gameState.tableau[i];
                if (column.length > 0) {
                    const topCard = column[column.length - 1];
                    
                    // –ò—â–µ–º —Å—Ç–æ–ª–±–µ—Ü, –∫—É–¥–∞ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —ç—Ç—É –∫–∞—Ä—Ç—É
                    for (let j = 0; j < 10; j++) {
                        if (i !== j) {
                            if (gameState.tableau[j].length === 0) {
                                // –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –Ω–∞ –ø—É—Å—Ç–æ–π —Å—Ç–æ–ª–±–µ—Ü
                                const cardElement = document.querySelector(`#tableau-${i} .card:last-child`);
                                cardElement.style.boxShadow = '0 0 10px gold';
                                break;
                            } else {
                                const targetTopCard = gameState.tableau[j][gameState.tableau[j].length - 1];
                                if (getCardValue(targetTopCard.value) === getCardValue(topCard.value) + 1) {
                                    const cardElement = document.querySelector(`#tableau-${i} .card:last-child`);
                                    cardElement.style.boxShadow = '0 0 10px gold';
                                    break;
                                }
                            }
                        }
                    }
                }
            }
            
            // –ß–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã —É–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É
            setTimeout(() => {
                document.querySelectorAll('.card').forEach(card => {
                    card.style.boxShadow = '';
                });
            }, 2000);
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
        function toggleTheme() {
            if (gameState.theme === 'light') {
                gameState.theme = 'dark';
                body.classList.add('dark-theme');
                themeToggle.innerHTML = '<span class="theme-icon">üåì</span> –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞';
            } else {
                gameState.theme = 'light';
                body.classList.remove('dark-theme');
                themeToggle.innerHTML = '<span class="theme-icon">üåì</span> –¢—ë–º–Ω–∞—è —Ç–µ–º–∞';
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', initGame);
    </script>
</body>
</html>